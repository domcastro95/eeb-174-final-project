# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/PyRate_Canis/Trial_1/pyrate_mcmc_logs/canis_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/PyRate_Canis/Trial_1/pyrate_mcmc_logs/canis_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.130657654078, 0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078,0.130657654078)
L_hpd_M95=c(0.322306487696, 0.322306487696,0.322306487696,0.318688167094,0.318688167094,0.318688167094,0.318688167094,0.318688167094,0.318688167094,0.318688167094,0.313877520182,0.313877520182,0.313877520182,0.313877520182,0.313877520182,0.313877520182,0.313877520182,0.313877520182,0.313877520182,0.313877520182,0.313877520182,0.313877520182)
M_hpd_m95=c(0.00825502748498, 0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498,0.00825502748498)
M_hpd_M95=c(0.0770394347722, 0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722,0.0770394347722)
R_hpd_m95=c(0.0965918737778, 0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778,0.0965918737778)
R_hpd_M95=c(0.298216287615, 0.298216287615,0.298216287615,0.291595764769,0.291595764769,0.291595764769,0.291595764769,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615,0.298216287615)
L_mean=c(0.228873759184, 0.228873759184,0.229244458217,0.229481878403,0.229481878403,0.229481878403,0.228099596989,0.226194001652,0.226194001652,0.226194001652,0.224477456542,0.22279156086,0.222480010034,0.22256655165,0.222650564319,0.222650564319,0.222650564319,0.222650564319,0.222650564319,0.222650564319,0.222650564319,0.222650564319)
M_mean=c(0.0446888037602, 0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602,0.0446888037602)
R_mean=c(0.184184955424, 0.184184955424,0.184555654457,0.184793074643,0.184793074643,0.184793074643,0.183410793228,0.181505197892,0.181505197892,0.181505197892,0.179788652782,0.1781027571,0.177791206274,0.17787774789,0.177961760558,0.177961760558,0.177961760558,0.177961760558,0.177961760558,0.177961760558,0.177961760558,0.177961760558)
trans=0.5
age=(0:(22-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.354537136466), xlim = c(-23.1,1.1), ylab = 'Speciation rate', xlab = 'Ma',main='canis' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.0847433782495), xlim = c(-23.1,1.1), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.106251061156, 0.328037916377), xlim = c(-23.1,1.1), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-23.1,1.1), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()